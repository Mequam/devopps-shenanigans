pipeline {
    agent any
    environment {
       DOCKER_CREDS = credentials('docker')
    }
    stages {
        stage('Clone Repo') {
            steps {
               checkout scm
            }
        }
        stage('Build') {
            steps {
                sh 'cd api'
                sh 'docker build -t mequam/django-vote-v1'
            }
        }
        stage('Push Image') {
           steps {
               sh 'docker login --username=$DOCKER_CREDS_USR --password=$DOCKER_CREDS_PSW'
               sh 'docker push mequam/django-vote-v1'
           }
        }
    }
}
